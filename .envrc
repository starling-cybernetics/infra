# VS Code is installed (on my system) in an FHS env, which prevents the `op` command from working
if [ "$TERM_PROGRAM" != "vscode" ]; then
  # Load all the environment variables from 1Password into the current shell, as well as all the
  # normal non-secret environment variables from the .env file.
  eval $(sed -e 's!#.*!!g; s!^\([A-Z_][A-Z0-9_]*\) *= *\(["'\'']op://.*["'\'']\) *$!\1="$\(op read \2\)"!g; s!^\([A-Z_][A-Z0-9_]*\)=!export \1=!g' < ./.env)
fi

use flake